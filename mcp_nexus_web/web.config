<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <system.web>
    <!-- Enable compilation of ASP.NET pages -->
    <compilation debug="true" targetFramework="4.0" />
    
    <!-- Set maximum file upload size (2GB) and memory management -->
    <httpRuntime maxRequestLength="2097152" executionTimeout="3600" 
                 maxRequestLength="2097152" 
                 requestLengthDiskThreshold="8192" 
                 enableVersionHeader="false" />
    
    <!-- Trust level for application execution -->
    <trust level="Full" />
    
    <!-- Custom error handling -->
    <customErrors mode="Off" />
    
    <!-- Enable session state if needed -->
    <sessionState mode="InProc" timeout="20" />
  </system.web>
  
  <system.webServer>
    <!-- Configure request limits for IIS 7+ -->
    <security>
      <requestFiltering>
        <!-- Maximum file size: 2GB (bytes) for large dump files -->
        <requestLimits maxAllowedContentLength="2147483648" />
      </requestFiltering>
    </security>
    
    <!-- Default documents -->
    <defaultDocument>
      <files>
        <clear />
        <add value="index.html" />
        <add value="analyses-simple.html" />
        <add value="analyses.html" />
        <add value="Default.aspx" />
        <add value="default.htm" />
      </files>
    </defaultDocument>
    
    <!-- Remove custom handlers temporarily for basic functionality -->
    
    <!-- MIME types for various file extensions -->
    <staticContent>
      <remove fileExtension=".json" />
      <mimeMap fileExtension=".json" mimeType="application/json" />
      <remove fileExtension=".css" />
      <mimeMap fileExtension=".css" mimeType="text/css" />
      <remove fileExtension=".woff" />
      <mimeMap fileExtension=".woff" mimeType="application/font-woff" />
      <remove fileExtension=".woff2" />
      <mimeMap fileExtension=".woff2" mimeType="font/woff2" />
      <remove fileExtension=".md" />
      <mimeMap fileExtension=".md" mimeType="text/markdown" />
      <remove fileExtension=".dmp" />
      <mimeMap fileExtension=".dmp" mimeType="application/octet-stream" />
    </staticContent>
    
    <!-- HTTP response headers -->
    <httpProtocol>
      <customHeaders>
        <add name="X-Content-Type-Options" value="nosniff" />
        <add name="X-Frame-Options" value="SAMEORIGIN" />
        <add name="X-XSS-Protection" value="1; mode=block" />
      </customHeaders>
    </httpProtocol>
    
    <!-- Directory browsing (disabled for security) -->
    <directoryBrowse enabled="false" />
  </system.webServer>
  
  <!-- Application settings -->
  <appSettings>
    <!-- Upload directory path -->
    <add key="UploadPath" value="~/uploads" />
    
    <!-- Log directory path -->
    <add key="LogPath" value="~/logs" />
    
    <!-- Maximum files per upload -->
    <add key="MaxFilesPerUpload" value="10" />
    
    <!-- WSL command timeout in seconds -->
    <add key="WSLCommandTimeout" value="60" />
    
    <!-- Allowed file extensions (comma-separated) - leave empty to allow all -->
    <add key="AllowedExtensions" value="" />
    
    <!-- Memory management settings -->
    <add key="MaxFileSizeMB" value="2048" />
    <add key="StreamBufferSizeKB" value="8" />
    <add key="MaxConcurrentUploads" value="5" />
    <add key="EnableMemoryOptimization" value="true" />
  </appSettings>
  
  <!-- Connection strings (if database is needed) -->
  <connectionStrings>
    <!-- Example connection string -->
    <!-- <add name="DefaultConnection" connectionString="Data Source=.\SQLEXPRESS;Initial Catalog=YourDB;Integrated Security=True" providerName="System.Data.SqlClient" /> -->
  </connectionStrings>
</configuration>
